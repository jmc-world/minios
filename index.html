<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JMC (Mini OS)</title>
    <!-- Memuat Tailwind CSS untuk styling responsif --><script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        /* Menggunakan font Inter */
        body { font-family: 'Inter', sans-serif; }

        /* Estetika: Warna Merah Putih Utama */
        .desktop-bg {
            background-color: #f0f0f0; /* Latar belakang abu-abu muda */
            background-image: linear-gradient(45deg, #FF0000 25%, #FFFFFF 25%, #FFFFFF 50%, #FF0000 50%, #FF0000 75%, #FFFFFF 75%, #FFFFFF 100%);
            background-size: 50px 50px;
        }

        /* Styling Jendela Aplikasi (Popup) */
        .window-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 100;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .window {
            width: 95%; /* Tetap 95% untuk responsivitas penuh */
            height: 95%; /* Tetap 95% untuk responsivitas penuh */
            max-width: 1500px; /* Diperbesar 50% dari 1000px */
            max-height: 1050px; /* Diperbesar 50% dari 700px */
            background-color: white;
            border: 2px solid #FF0000;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.4);
            display: flex;
            flex-direction: column;
        }

        .window-header {
            background-color: #FF0000;
            color: white;
            padding: 8px 16px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: move; /* Indikator drag */
        }
        
        /* Tambahan untuk kelompok kontrol di header */
        .window-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .window-body {
            flex-grow: 1;
            padding: 1rem;
            overflow-y: auto;
            background-color: #FFFFFF;
        }
        
        /* Mengatur agar teks tidak bisa disalin */
        .no-copy {
            -webkit-user-select: none;  /* Safari */
            -moz-user-select: none;    /* Firefox */
            -ms-user-select: none;      /* IE10+ */
            user-select: none;          /* Standard syntax */
        }
        
        /* Styling untuk tombol kalkulator */
        .calc-button {
            @apply p-4 font-bold text-xl rounded-lg transition duration-200 hover:opacity-90;
        }

        /* Responsif untuk tombol kalkulator pada perangkat kecil */
        @media (max-width: 640px) {
            .calc-button {
                @apply p-3 text-lg;
            }
        }
    </style>
</head>
<body class="no-copy">

    <!-- Konten Utama Desktop (Merah Putih) --><div id="desktop" class="desktop-bg min-h-screen flex flex-col no-copy">
        
        <!-- Taskbar (Merah Solid) --><div id="taskbar" class="bg-red-700 text-white p-2 flex justify-between items-center shadow-lg sticky top-0 z-50">
            <div class="font-extrabold text-xl tracking-wider">JMC (Mini OS)</div>
            <div id="clock" class="text-sm font-mono">10:45 AM</div>
        </div>

        <!-- Area Desktop dengan Ikon --><div class="flex-grow p-4 md:p-8 grid grid-cols-3 sm:grid-cols-4 lg:grid-cols-6 gap-6">

            <!-- Ikon My Apps --><button onclick="openFileExplorer()" class="flex flex-col items-center p-3 w-24 sm:w-28 rounded-xl hover:bg-gray-200 transition-colors">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-12 h-12 text-blue-600 mb-1" viewBox="0 0 24 24" fill="currentColor"><path d="M10.15 3C10.51 3 10.84 3.19 11.03 3.5L12 5.5H20C21.1 5.5 22 6.4 22 7.5V18.5C22 19.6 21.1 20.5 20 20.5H4C2.9 20.5 2 19.6 2 18.5V4.5C2 3.84 2.37 3.25 2.95 3H10.15M10 4.5H3.5C3.22 4.5 3 4.72 3 5V18.5C3 19.05 3.45 19.5 4 19.5H20C20.55 19.5 21 19.05 21 18.5V7.5C21 6.95 20.55 6.5 20 6.5H12.5C12.14 6.5 11.8 6.31 11.61 6L10.65 4H10M4 19.5V5H9L10 6.5H20V18.5H4Z" /></svg>
                <span class="text-xs sm:text-sm text-center font-medium">My Apps</span>
            </button>
            
        </div>
    </div>

    <!-- Jendela Aplikasi (Modal) --><div id="appWindowContainer" class="window-container hidden">
        <div id="appWindow" class="window rounded-xl">
            <div id="appHeader" class="window-header rounded-t-xl">
                <span id="appTitle">Aplikasi JMC OS</span>
                <div class="window-controls">
                    <!-- Tombol "Kembali ke My Apps" (Hanya ditampilkan jika bukan di My Apps) --><button id="backToAppsBtn" onclick="openFileExplorer()" class="text-sm font-medium bg-white text-red-700 px-3 py-1 rounded-full hover:bg-red-100 transition-colors hidden">
                        Kembali ke My Apps
                    </button>
                    <!-- Tombol Tutup --><button onclick="closeApp()" class="text-lg font-extrabold hover:text-gray-300 transition-colors px-2">X</button>
                </div>
            </div>
            <div id="appBody" class="window-body rounded-b-xl">
                <!-- Konten aplikasi akan dimuat di sini --></div>
        </div>
    </div>

    <!-- Templates Konten Aplikasi (Disembunyikan) --><template id="fileExplorerTemplate">
        <h2 class="text-2xl font-bold text-red-700 mb-4">My Apps</h2>
        <div class="grid grid-cols-2 md:grid-cols-3 gap-6">
            
            <!-- Kalkulator --><button onclick="openApp('calculator')" class="p-4 bg-gray-100 rounded-lg shadow-md hover:bg-gray-200 transition-colors flex flex-col items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-10 h-10 text-red-600 mb-2" viewBox="0 0 24 24" fill="currentColor"><path d="M16 4H8C6.9 4 6 4.9 6 6V18C6 19.1 6.9 20 8 20H16C17.1 20 18 19.1 18 18V6C18 4.9 17.1 4 16 4M12 7C12.55 7 13 7.45 13 8V9C13 9.55 12.55 10 12 10H11C10.45 10 10 9.55 10 9V8C10 7.45 10.45 7 11 7H12M12 11C12.55 11 13 11.45 13 12V13C13 13.55 12.55 14 12 14H11C10.45 14 10 13.55 10 13V12C10 11.45 10.45 11 11 11H12M12 15C12.55 15 13 15.45 13 16V17C13 17.55 12.55 18 12 18H11C10.45 18 10 17.55 10 17V16C10 15.45 10.45 15 11 15H12M9 7C9.55 7 10 7.45 10 8V9C10 9.55 9.55 10 9 10H8C7.45 10 7 9.55 7 9V8C7 7.45 7.45 7 8 7H9M9 11C9.55 11 10 11.45 10 12V13C10 13.55 9.55 14 9 14H8C7.45 14 7 13.55 7 13V12C7 11.45 7.45 11 8 11H9M9 15C9.55 15 10 15.45 10 16V17C10 17.55 9.55 18 9 18H8C7.45 18 7 17.55 7 17V16C7 15.45 7.45 15 8 15H9M15 7C15.55 7 16 7.45 16 8V9C16 9.55 15.55 10 15 10H14C13.45 10 13 9.55 13 9V8C13 7.45 13.45 7 14 7H15M15 11C15.55 11 16 11.45 16 12V13C16 13.55 15.55 14 15 14H14C13.45 14 13 13.55 13 13V12C13 11.45 13.45 11 14 11H15M15 15C15.55 15 16 15.45 16 16V17C16 17.55 15.55 18 15 18H14C13.45 18 13 17.55 13 17V16C13 15.45 13.45 15 14 15H15Z"/></svg>
                <span class="font-medium text-sm">Kalkulator Sederhana</span>
            </button>
            
            <!-- Catatan Markdown --><button onclick="openApp('notes')" class="p-4 bg-gray-100 rounded-lg shadow-md hover:bg-gray-200 transition-colors flex flex-col items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-10 h-10 text-red-600 mb-2" viewBox="0 0 24 24" fill="currentColor"><path d="M14 2H6C4.9 2 4 2.9 4 4V20C4 21.1 4.9 22 6 22H18C19.1 22 20 21.1 20 20V8L14 2M18 20H6V4H13V9H18V20M8 12V14H16V12H8M8 16V18H16V16H8Z" /></svg>
                <span class="font-medium text-sm">Catatan Markdown</span>
            </button>

            <!-- Stopwatch --><button onclick="openApp('stopwatch')" class="p-4 bg-gray-100 rounded-lg shadow-md hover:bg-gray-200 transition-colors flex flex-col items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-10 h-10 text-red-600 mb-2" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.47 2 2 6.47 2 12C2 17.53 6.47 22 12 22C17.53 22 22 17.53 22 12C22 6.47 17.53 2 12 2M12 20C7.58 20 4 16.42 4 12C4 7.58 7.58 4 12 4C16.42 4 20 7.58 20 12C20 16.42 16.42 20 12 20M13 7H11V13L16.2 16.3L17.1 14.8L13 12.3V7Z" /></svg>
                <span class="font-medium text-sm">Stopwatch Sederhana</span>
            </button>
        </div>
    </template>

    <template id="calculatorTemplate">
        <div class="flex flex-col h-full space-y-4">
            <input type="text" id="calcDisplay" class="w-full text-4xl p-4 text-right border-4 border-red-700 rounded-lg bg-gray-100 font-mono focus:outline-none" value="0" readonly>
            <div class="grid grid-cols-4 gap-3 flex-grow">
                <!-- Baris 1 --><button class="calc-button bg-red-200 text-red-800 col-span-2" onclick="clearCalc()">AC</button>
                <button class="calc-button bg-red-500 text-white" onclick="appendInput('/')">÷</button>
                <button class="calc-button bg-red-500 text-white" onclick="appendInput('*')">×</button>
                <!-- Baris 2 --><button class="calc-button bg-gray-300 text-gray-800" onclick="appendInput('7')">7</button>
                <button class="calc-button bg-gray-300 text-gray-800" onclick="appendInput('8')">8</button>
                <button class="calc-button bg-gray-300 text-gray-800" onclick="appendInput('9')">9</button>
                <button class="calc-button bg-red-500 text-white" onclick="appendInput('-')">−</button>
                <!-- Baris 3 --><button class="calc-button bg-gray-300 text-gray-800" onclick="appendInput('4')">4</button>
                <button class="calc-button bg-gray-300 text-gray-800" onclick="appendInput('5')">5</button>
                <button class="calc-button bg-gray-300 text-gray-800" onclick="appendInput('6')">6</button>
                <button class="calc-button bg-red-500 text-white" onclick="appendInput('+')">+</button>
                <!-- Baris 4 --><button class="calc-button bg-gray-300 text-gray-800" onclick="appendInput('1')">1</button>
                <button class="calc-button bg-gray-300 text-gray-800" onclick="appendInput('2')">2</button>
                <button class="calc-button bg-gray-300 text-gray-800" onclick="appendInput('3')">3</button>
                <button class="calc-button bg-red-800 text-white row-span-2" onclick="calculate()">=</button>
                <!-- Baris 5 --><button class="calc-button bg-gray-300 text-gray-800 col-span-2" onclick="appendInput('0')">0</button>
                <button class="calc-button bg-gray-300 text-gray-800" onclick="appendInput('.')">.</button>
            </div>
        </div>
    </template>

    <template id="notesTemplate">
        <h2 class="text-2xl font-bold text-red-700 mb-4">Catatan Sederhana (Markdown)</h2>
        
        <!-- Toolbar Markdown --><div class="flex space-x-2 mb-3">
            <button onclick="applyMarkdown('bold')" class="p-2 bg-red-500 text-white rounded-lg font-bold hover:bg-red-600 transition-colors">B</button>
            <button onclick="applyMarkdown('italic')" class="p-2 bg-red-500 text-white rounded-lg italic hover:bg-red-600 transition-colors">I</button>
            <button onclick="applyMarkdown('underline')" class="p-2 bg-red-500 text-white rounded-lg underline hover:bg-red-600 transition-colors">U</button>
        </div>

        <div class="flex flex-col lg:flex-row h-[75%] space-y-4 lg:space-y-0 lg:space-x-4">
            <!-- Input Textarea --><textarea id="noteInput" class="flex-1 p-3 border-2 border-gray-300 rounded-lg focus:border-red-500 resize-none text-base" oninput="renderMarkdown()" placeholder="Tulis catatan Anda di sini...&#10;Gunakan **tebal**, *miring*, atau __garisbawah__"></textarea>
            
            <!-- Output Pratinjau --><div id="noteOutput" class="flex-1 p-4 border-2 border-red-200 rounded-lg bg-red-50 overflow-y-auto">
                <p class="text-gray-500 italic">Pratinjau Markdown akan muncul di sini.</p>
            </div>
        </div>
        <p class="text-xs text-gray-500 mt-2">Catatan: Markdown disederhanakan: **Tebal**, *Miring*, dan <u>Garis Bawah</u>.</p>
    </template>

    <template id="stopwatchTemplate">
        <div class="flex flex-col items-center justify-center h-full space-y-8">
            <h2 class="text-3xl font-bold text-red-700">Stopwatch JMC</h2>
            
            <!-- Tampilan Waktu --><div id="stopwatchDisplay" class="text-7xl md:text-9xl font-mono font-extrabold text-red-900 bg-red-100 p-8 rounded-2xl shadow-xl border-4 border-red-500">
                00:00:00
            </div>

            <!-- Tombol Kontrol --><div class="flex space-x-4 md:space-x-8">
                <button onclick="startStopwatch()" id="startBtn" class="p-4 md:p-6 bg-green-500 text-white rounded-full font-bold text-lg shadow-lg hover:bg-green-600 transition duration-150 transform hover:scale-105">
                    Mulai
                </button>
                <button onclick="pauseStopwatch()" id="pauseBtn" class="p-4 md:p-6 bg-yellow-500 text-white rounded-full font-bold text-lg shadow-lg hover:bg-yellow-600 transition duration-150 transform hover:scale-105" disabled>
                    Jeda
                </button>
                <button onclick="resetStopwatch()" class="p-4 md:p-6 bg-red-500 text-white rounded-full font-bold text-lg shadow-lg hover:bg-red-600 transition duration-150 transform hover:scale-105">
                    Reset
                </button>
            </div>
        </div>
    </template>

    <script>
        // === Global State & Initialization ===
        let currentApp = null;
        const appWindowContainer = document.getElementById('appWindowContainer');
        const appTitle = document.getElementById('appTitle');
        const appBody = document.getElementById('appBody');
        const backToAppsBtn = document.getElementById('backToAppsBtn');
        const templates = {
            'fileExplorer': document.getElementById('fileExplorerTemplate'),
            'calculator': document.getElementById('calculatorTemplate'),
            'notes': document.getElementById('notesTemplate'),
            'stopwatch': document.getElementById('stopwatchTemplate')
        };
        const appTitles = {
            'fileExplorer': 'My Apps',
            'calculator': 'Kalkulator Sederhana',
            'notes': 'Catatan Markdown',
            'stopwatch': 'Stopwatch'
        };

        // Mengatur jam dan perlindungan konten saat DOM siap
        document.addEventListener('DOMContentLoaded', () => {
            updateClock();
            setInterval(updateClock, 1000);
            
            // Mencegah klik kanan, salin, dan potong di seluruh dokumen untuk perlindungan konten
            document.body.oncontextmenu = () => false;
            document.body.oncopy = () => false;
            document.body.oncut = () => false;
        });

        function updateClock() {
            const now = new Date();
            document.getElementById('clock').textContent = now.toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
        }
        
        // === Fungsi Pembuka/Penutup Aplikasi ===
        function openFileExplorer() {
            openApp('fileExplorer');
        }

        function openApp(appName) {
            // Hentikan interval stopwatch sebelum beralih aplikasi
            if (currentApp === 'stopwatch' && appName !== 'stopwatch') {
                clearInterval(stopwatchInterval);
                isRunning = false; // Pastikan status stopwatch disetel ulang
                runningTime = 0;
            }

            currentApp = appName;
            
            // 1. Bersihkan body aplikasi
            appBody.innerHTML = '';

            // 2. Tentukan template yang akan digunakan
            const template = templates[appName];
            if (!template) {
                appBody.innerHTML = '<p class="text-red-500">Aplikasi tidak ditemukan.</p>';
                appTitle.textContent = 'Error';
                return;
            }

            // 3. Clone konten template dan masukkan ke appBody
            const content = template.content.cloneNode(true);
            appBody.appendChild(content);

            // 4. Atur judul jendela
            appTitle.textContent = appTitles[appName];

            // 5. Atur visibilitas tombol kembali
            if (appName !== 'fileExplorer') {
                backToAppsBtn.classList.remove('hidden');
            } else {
                backToAppsBtn.classList.add('hidden');
            }

            // 6. Tampilkan jendela
            appWindowContainer.classList.remove('hidden');
            
            // 7. Jalankan inisialisasi spesifik aplikasi (jika ada)
            if (appName === 'stopwatch') {
                updateStopwatchDisplay(); // Perbarui tampilan stopwatch saat dibuka
            }
        }

        function closeApp() {
            // Hentikan interval stopwatch sebelum menutup
            if (currentApp === 'stopwatch') {
                clearInterval(stopwatchInterval);
                isRunning = false; // Reset status stopwatch
                runningTime = 0;
            }
            currentApp = null;
            appWindowContainer.classList.add('hidden');
            appBody.innerHTML = '';
        }

        // === Kalkulator Logic ===
        let displayValue = '0';
        let operator = null;
        let waitingForSecondOperand = false;
        let firstOperand = null;
        
        function updateDisplay(value) {
            document.getElementById('calcDisplay').value = value;
        }

        function appendInput(input) {
            const display = document.getElementById('calcDisplay');
            const isOperator = ['+', '-', '*', '/'].includes(input);

            if (input === 'AC') {
                clearCalc();
                return;
            }

            if (isOperator) {
                if (firstOperand !== null && operator !== null) {
                    calculate(); 
                }
                
                firstOperand = parseFloat(display.value);
                operator = input;
                waitingForSecondOperand = true;
                if (display.value !== 'Error') {
                    display.value = firstOperand + ' ' + input; 
                }
            } else if (input === '=') {
                calculate();
            } else {
                if (waitingForSecondOperand || display.value === 'Error') {
                    display.value = input;
                    waitingForSecondOperand = false;
                } else {
                    if (display.value === '0' && input !== '.') {
                        display.value = input;
                    } else if (input === '.' && display.value.includes('.')) {
                        return;
                    } else {
                        display.value += input;
                    }
                }
            }
            displayValue = display.value;
        }
        
        function clearCalc() {
            displayValue = '0';
            firstOperand = null;
            operator = null;
            waitingForSecondOperand = false;
            updateDisplay('0');
        }

        function calculate() {
            const display = document.getElementById('calcDisplay');
            if (firstOperand === null || operator === null || waitingForSecondOperand) return;

            const displayParts = display.value.split(' ');
            const secondOperand = parseFloat(displayParts[displayParts.length - 1]);
            
            if (isNaN(secondOperand)) {
                return;
            }

            let result;

            switch (operator) {
                case '+':
                    result = firstOperand + secondOperand;
                    break;
                case '-':
                    result = firstOperand - secondOperand;
                    break;
                case '*':
                    result = firstOperand * secondOperand;
                    break;
                case '/':
                    if (secondOperand === 0) {
                        display.value = 'Error';
                        clearCalc();
                        return;
                    }
                    result = firstOperand / secondOperand;
                    break;
                default:
                    return;
            }

            displayValue = String(result);
            firstOperand = result;
            operator = null; 
            waitingForSecondOperand = true;

            updateDisplay(displayValue);
        }

        // === Catatan Markdown Logic ===
        function renderMarkdown() {
            const input = document.getElementById('noteInput').value;
            const outputDiv = document.getElementById('noteOutput');

            let htmlContent = input;

            htmlContent = htmlContent.replace(/__(.*?)__/gs, '<u>$1</u>');
            htmlContent = htmlContent.replace(/\*\*(.*?)\*\*/gs, '<strong>$1</strong>');
            htmlContent = htmlContent.replace(/\*(.*?)\*/gs, '<em>$1</em>');
            htmlContent = htmlContent.replace(/\n/g, '<br>');

            outputDiv.innerHTML = htmlContent || '<p class="text-gray-500 italic">Pratinjau Markdown akan muncul di sini.</p>';
        }

        function applyMarkdown(style) {
            const textarea = document.getElementById('noteInput');
            const start = textarea.selectionStart;
            const end = textarea.selectionEnd;
            const selectedText = textarea.value.substring(start, end);
            let replacementText = selectedText;

            switch (style) {
                case 'bold':
                    replacementText = `**${selectedText}**`;
                    break;
                case 'italic':
                    replacementText = `*${selectedText}*`;
                    break;
                case 'underline':
                    replacementText = `__${selectedText}__`;
                    break;
            }

            textarea.value = textarea.value.substring(0, start) + replacementText + textarea.value.substring(end);
            
            textarea.focus();
            renderMarkdown();
        }

        // === Stopwatch Logic ===
        let stopwatchInterval = null;
        let runningTime = 0; // Waktu dalam milidetik
        let isRunning = false;
        
        function formatTime(ms) {
            const totalSeconds = Math.floor(ms / 1000);
            const hours = Math.floor(totalSeconds / 3600);
            const minutes = Math.floor((totalSeconds % 3600) / 60);
            const seconds = totalSeconds % 60;
            const milliseconds = Math.floor((ms % 1000) / 10);

            const pad = (num, digits = 2) => String(num).padStart(digits, '0');

            return `${pad(hours)}:${pad(minutes)}:${pad(seconds)}.${pad(milliseconds)}`;
        }

        function updateStopwatchDisplay() {
            const display = document.getElementById('stopwatchDisplay');
            if (display) {
                display.textContent = formatTime(runningTime);
            }
            const startBtn = document.getElementById('startBtn');
            const pauseBtn = document.getElementById('pauseBtn');
            if (startBtn && pauseBtn) {
                startBtn.disabled = isRunning;
                pauseBtn.disabled = !isRunning;
            }
        }

        function startStopwatch() {
            if (isRunning) return;
            isRunning = true;
            
            const startTime = Date.now() - runningTime;

            stopwatchInterval = setInterval(() => {
                runningTime = Date.now() - startTime;
                updateStopwatchDisplay();
            }, 10);

            updateStopwatchDisplay();
        }

        function pauseStopwatch() {
            if (!isRunning) return;
            isRunning = false;
            clearInterval(stopwatchInterval);
            
            updateStopwatchDisplay();
        }

        function resetStopwatch() {
            pauseStopwatch();
            runningTime = 0;
            updateStopwatchDisplay();
        }

    </script>
</body>
</html>

